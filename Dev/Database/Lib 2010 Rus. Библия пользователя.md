# Lib 2010 Rus. Библия пользователя

## Links
[Кригель, Трухнов: SQL. Библия пользователя](https://www.labirint.ru/books/222894/)

## null  значения
sql server по умолчанию: select 1 + null = null,  null1 != null2
is null                      -- проверка значения
concat_null_yealds_null off  -- игнорировать пустое значение в выражении
ansi nulls                   -- будет ли null1 = null2

## Повышение производительности - Теория опмтимизации и SQL Server
1. Модель схемы
   1 - избегать чрезмерной сложности
   2 - тшательно выбирать ключи
   3 - следить за необязательными данными
   4 - использовать некоторый уровень абстракции
2. Использование пакетных запросов быстрее, чем однострочных
   Методика
   Задача                          -  Лучшее решение
   Сложная бизнес-логика           -  запросы, позапросы, CTE
   Динамическое генерирование DDL  -  Курсоры
   Перестройка списка              -  Переменные или курсор
   Прохождение по иерархии         -  Пользовательская ф-ия или CTE
   Накопительные суммы             -  Курсор
3. Индексация - является мостом между запросами и данными, и одновременно ключевой стратегией
4. Конкуренция
   Блокировка - сложная проблема, чем вынуждает понижать уровень изоляции транзакции до nolock
   Осторожнее с логикой в триггерах, т.к. все равно задействована в транзакциях
5. Расширенная масштабируемость
   1 - изоляция мгновенных снимков
   2 - разделение таблиц
   3 - индексированне представления
   4 - брокер служб
Резюме: 7 правил организации хранилиш данных
1. Простота
2. Полезность
3. Целостность данных
4. Производительность
5. Доступность
6. Масштабируемость
7. Безопасность

## Моделирование БД
1. Исследование и сбор данных
2. Логическое представление реальности
3. Идентификация  и прокетирование видимых сущностей
4. Разработка схемы
5. Проектирвание структуры приложения
Физическая модель лучше строится, после продуманной логической модели.
Цель логической модели - документирование сущностей и из взаимосвязей.
Реляционная БД - все однородные или связанные данные сведены в одну сущность.
Хорошо спроектированные сущности имеют массу однотипных элементов.
Первичный ключ - уникальный атрибут
Разработка логической модели требует наличия множества сущностей
1. Множество объектов
   - один объект может являться списком множетсва других
2. Отношения между объектами
3. Организация и группировка объектов
4. Целостность значений
   - вхождение в определённый диапазон значений
5. Сложные объекты
Реляционные шаблоны
 - Отношения между сущностями с помощю ключей
Вторичные сущности и внешние ключи
 - Отношение "один ко многим": внешние ключ вторичной сущности связан с первичным главной.
Строгость отношения
 - первичный ключ допускает наличие одного объекта
 - внешний ключ допускает наличие множества объектов
Варианты строгости
1. Один к одному - применяется при создании конфиденциальной информации	
2. Один ко многим
3. Многие ко многим - включает стыковочную таблицу "один ко многим"
Таблица классификаторов
Вовзвратные отношения (рекурсивные)

## Нормализация
 - Сокращение аномалий обновления. Подходит для оперативных данных.
Преимущества нормализованной фомы
1. Повышенная целостность делает невозможным двойное хранение данных
2. Сокращение споров за блокировку ресурсов и улучшенная многопользовательская конкуренция
3. Меньшие размеры файлов
                                1НФ (первая нормальная форма)
 - данные объединены в сущности и увовлетворяют условиям
1. Каждая еденица данных представленная в скалярном атрибуте
2. Все данные должны быть представленны уникальными атрбибутами
3. Все данные должны содержаться в уникальных элементах
